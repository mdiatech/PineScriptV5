
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  
<!-- Mirrored from www.tradingview.com/pine-script-docs/en/v5/migration_guides/To_Pine_version_4.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 04 Sep 2023 17:57:06 GMT -->
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>To Pine Script® version 4 &#8212; Pine Script® v5 User Manual v5 documentation</title>
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../../../../../static.tradingview.com/static/bundles/pine-highlighter-v01.js"></script>
    <script type="text/javascript" src="../_static/highlight-pine-code.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="To Pine Script® version 3" href="To_Pine_version_3.html" />
    <link rel="prev" title="To Pine Script® version 5" href="To_Pine_version_5.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="To_Pine_version_3.html" title="To Pine Script® version 3"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="To_Pine_version_5.html" title="To Pine Script® version 5"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Pine Script® v5 User Manual v5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Migration guides</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="../index.html" class="text-logo">Pine Script<sup>®</sup> v5 User Manual</a>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction.html">Welcome to Pine Script<sup>®</sup> v5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../primer/index.html">Pine Script<sup>®</sup> primer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/index.html">Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../writing/index.html">Writing scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Error_messages.html">Error messages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Release_notes.html">Release notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Migration guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="To_Pine_version_5.html">To Pine Script<sup>®</sup> version 5</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">To Pine Script<sup>®</sup> version 4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#converter">Converter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#renaming-of-built-in-constants-variables-and-functions">Renaming of built-in constants, variables, and functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#explicit-variable-type-declaration">Explicit variable type declaration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="To_Pine_version_3.html">To Pine Script<sup>®</sup> version 3</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Where_can_I_get_more_information.html">Where can I get more information?</a></li>
</ul>

    
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="https://www.tradingview.com/pine-script-docs/en/v5/search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">User Manual</a></li>
              
                <li><a href="index.html">Migration guides</a></li>
              
              <li>To Pine Script<sup>®</sup> version 4</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <a class="reference external image-reference" href="../Introduction.html"><div align="right" class="align-right"><img alt="Pine Script® logo" height="100" src="../_images/Pine-script-logo.svg" width="100" /></div>
</a>
<div class="section" id="to-pine-script-version-4">
<span id="pagetopineversion4"></span><h1>To Pine Script<sup>®</sup> version 4<a class="headerlink" href="#to-pine-script-version-4" title="Permalink to this headline">¶</a></h1>
<p>This is a guide to converting Pine Script<sup>®</sup> code from <code class="docutils literal notranslate"><span class="pre">&#64;version=3</span></code> to <code class="docutils literal notranslate"><span class="pre">&#64;version=4</span></code>.</p>
<div class="section" id="converter">
<h2>Converter<a class="headerlink" href="#converter" title="Permalink to this headline">¶</a></h2>
<p>The Pine Script<sup>®</sup> Editor comes with a utility to automatically convert v3 indicators and strategies to v4. To access it, open a script with <code class="docutils literal notranslate"><span class="pre">//&#64;version=3</span></code> in it and select the <code class="docutils literal notranslate"><span class="pre">Convert</span> <span class="pre">to</span> <span class="pre">v4</span></code> option in the <code class="docutils literal notranslate"><span class="pre">More</span></code> dropdown menu:</p>
<img alt="../_images/v3_to_v4_convert_button.png" src="../_images/v3_to_v4_convert_button.png" />
<p>Not all scripts can be automatically converted from v3 to v4. If you want to convert the script manually or if your indicator returns a compilation error after conversion, consult the guide below for more information.</p>
</div>
<div class="section" id="renaming-of-built-in-constants-variables-and-functions">
<h2>Renaming of built-in constants, variables, and functions<a class="headerlink" href="#renaming-of-built-in-constants-variables-and-functions" title="Permalink to this headline">¶</a></h2>
<p>In Pine Script<sup>®</sup> v4 the following built-in constants, variables, and functions were renamed:</p>
<ul class="simple">
<li>Color constants (e.g <code class="docutils literal notranslate"><span class="pre">red</span></code>) are moved to the <code class="docutils literal notranslate"><span class="pre">color.*</span></code> namespace (e.g. <code class="docutils literal notranslate"><span class="pre">color.red</span></code>).</li>
<li>The <code class="docutils literal notranslate"><span class="pre">color</span></code> function has been renamed to <code class="docutils literal notranslate"><span class="pre">color.new</span></code>.</li>
<li>Constants for <code class="docutils literal notranslate"><span class="pre">input()</span></code> types (e.g. <code class="docutils literal notranslate"><span class="pre">integer</span></code>) are moved to the <code class="docutils literal notranslate"><span class="pre">input.*</span></code> namespace (e.g. <code class="docutils literal notranslate"><span class="pre">input.integer</span></code>).</li>
<li>The plot style constants (e.g. <code class="docutils literal notranslate"><span class="pre">histogram</span></code> style) are moved to the <code class="docutils literal notranslate"><span class="pre">plot.style_*</span></code> namespace (e.g. <code class="docutils literal notranslate"><span class="pre">plot.style_histogram</span></code>).</li>
<li>Style constants for the <code class="docutils literal notranslate"><span class="pre">hline</span></code> function (e.g. the <code class="docutils literal notranslate"><span class="pre">dotted</span></code> style) are moved to the <code class="docutils literal notranslate"><span class="pre">hline.style_*</span></code> namespace (e.g. <code class="docutils literal notranslate"><span class="pre">hline.style_dotted</span></code>).</li>
<li>Constants of days of the week (e.g. <code class="docutils literal notranslate"><span class="pre">sunday</span></code>) are moved to the <code class="docutils literal notranslate"><span class="pre">dayofweek.*</span></code> namespace (e.g.  <code class="docutils literal notranslate"><span class="pre">dayofweek.sunday</span></code>).</li>
<li>The variables of the current chart timeframe (e.g. <code class="docutils literal notranslate"><span class="pre">period</span></code>, <code class="docutils literal notranslate"><span class="pre">isintraday</span></code>) are moved to the <code class="docutils literal notranslate"><span class="pre">timeframe.*</span></code> namespace (e.g. <code class="docutils literal notranslate"><span class="pre">timeframe.period</span></code>, <code class="docutils literal notranslate"><span class="pre">timeframe.isintraday</span></code>).</li>
<li>The <code class="docutils literal notranslate"><span class="pre">interval</span></code> variable was renamed to <code class="docutils literal notranslate"><span class="pre">timeframe.multiplier</span></code>.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">ticker</span></code> and <code class="docutils literal notranslate"><span class="pre">tickerid</span></code> variables are renamed to <code class="docutils literal notranslate"><span class="pre">syminfo.ticker</span></code> and <code class="docutils literal notranslate"><span class="pre">syminfo.tickerid</span></code> respectively.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">n</span></code> variable that contains the bar index value has been renamed to <code class="docutils literal notranslate"><span class="pre">bar_index</span></code>.</li>
</ul>
<p>The reason behind renaming all of the above was to structure the standard language tools and make working with code easier. New names are grouped according to assignments under common prefixes. For example, you will see a list with all available color constants if you type ‘color’ in the editor and press Ctrl + Space.</p>
</div>
<div class="section" id="explicit-variable-type-declaration">
<h2>Explicit variable type declaration<a class="headerlink" href="#explicit-variable-type-declaration" title="Permalink to this headline">¶</a></h2>
<p>In Pine Script<sup>®</sup> v4 it’s no longer possible to create variables with an unknown data type at the time of their declaration. This was done to avoid a number of issues that arise when the variable type changes after its initialization with the na value. From now on, you need to explicitly specify their type using keywords or type functions (for example, <code class="docutils literal notranslate"><span class="pre">float</span></code>) when declaring variables with the na value:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>//@version=4
study(&quot;Green Candle Close&quot;)
// We expect `src` to hold float values, so we declare in with the `float` keyword
float src = na
if close &gt; open
    src := close
plot(src)
</pre></div>
</div>
<a class="reference external image-reference" href="https://www.tradingview.com/"><div align="center" class="align-center"><img alt="../_images/TradingView-Logo-Block.svg" src="../_images/TradingView-Logo-Block.svg" width="200px" /></div>
</a>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="To_Pine_version_5.html" title="previous chapter (use the left arrow)">To Pine Script<sup>®</sup> version 5</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="To_Pine_version_3.html" title="next chapter (use the right arrow)">To Pine Script<sup>®</sup> version 3</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="To_Pine_version_3.html" title="To Pine Script® version 3"
             >next</a> |</li>
        <li class="right" >
          <a href="To_Pine_version_5.html" title="To Pine Script® version 5"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Pine Script® v5 User Manual v5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Migration guides</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>

<script type="text/javascript" src="../_static/js/theme.js"></script>


<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Options</span>
    v: v5
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Languages</dt>
      
        <strong>
        <dd><a href="To_Pine_version_4.html">en</a></dd>
        </strong>
      
    </dl>
    <dl>
      <dt>Versions</dt>
      
        
        <dd><a href="https://www.tradingview.com/pine-script-docs/en/v3/migration_guides/To_Pine_version_4.html">v3</a></dd>
        
      
        
        <dd><a href="https://www.tradingview.com/pine-script-docs/en/v4/migration_guides/To_Pine_version_4.html">v4</a></dd>
        
      
        <strong>
        <dd><a href="To_Pine_version_4.html">v5</a></dd>
        </strong>
      
    </dl>
  </div>
</div>
<script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(false);
    });
</script>
  <div class="footer">
    &copy; Copyright 2023, TradingView.
  </div>
  </body>

<!-- Mirrored from www.tradingview.com/pine-script-docs/en/v5/migration_guides/To_Pine_version_4.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 04 Sep 2023 17:57:06 GMT -->
</html>